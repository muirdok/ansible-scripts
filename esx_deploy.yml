- hosts:
   - test
  user: root
  vars:
   vcenter_hostname: 10.3.53.123
   username: administrator
   password: Nexenta1
   newvmname: FPTESTVM
   template: w2012tmp
   resource_pool: "/Resources"
   cluster: Fixpack
   datacenter: QA
   esxname: 10.3.70.13
  tasks:
#  - name: Get info
#    vsphere_guest:
#      vcenter_hostname: "{{ vcenter_hostname }}"
#      username: "{{ username }}"
#      password: "{{ password }}"
#      guest: NEF{{ item }}
#      vmware_guest_facts: yes
#    with_items:
#       - testuser1
#       - testuser2
  - name: Deploy 5 Windows 2012 from template
    vsphere_guest:
      vcenter_hostname: "{{ vcenter_hostname }}"
      username: "{{ username }}"
      password: "{{ password }}"
      guest: "WindowsClient{{ item }}"
      from_template: yes
      template_src: windows-tmp
      resource_pool: "{{ resource_pool }}"
      cluster: "{{ cluster }}"
      esxi:
        datacenter: "{{ datacenter }}"
        hostname: "{{ esxname }}"
      with_items:
        - "-vm1"
        - "-vm2"
        - "-vm3"
        - "-vm4"
        - "-vm5"
